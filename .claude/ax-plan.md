# AX 기능 상세 기획 v2

## 전체 플로우

```
[1. 상담 노트테이킹]     [2. AI 정리]           [3. 문의 목록]        [4. 유사 견적 추천]
       |                      |                      |                      |
       v                      v                      v                      v
  자유롭게 메모         필수정보 취합           데이터 저장            이전 견적 불러오기
  (전화 중 빠르게)      미취합 정보 알림        상태 관리              업종별 추천
       |                      |                      |                      |
       +----------------------+----------------------+----------------------+
                                    |
                                    v
                            [5. 자동 팔로업]
                            n일 후 리마인더
                            AI 메시지 생성
```

---

# 기능 1. 상담 노트테이킹 (Consultation Notes)

## 컨셉
```
전화벨 울림 -> 노트 열기 -> 자유롭게 타이핑 -> AI가 알아서 정리
```

## 실무 시나리오: 전화 상담 중

### 상황
```
"안녕하세요, 마포에서 크로스핏 짐 오픈하는데요.
락커 견적 좀 받아볼 수 있을까요?"
```

### 현재 (Before)
```
대표: (종이에 메모하거나 머릿속으로)
      "마포... 피트니스... 뭐라고 했지..."
      (전화 끊고)
      "아 뭐였더라... 5열이었나 6열이었나..."
```

### AI 적용 후 (After)
```
대표: [새 상담] 버튼 클릭

시스템: +----------------------------------------+
        | [상담 노트] 새 상담                    |
        |                                        |
        | +------------------------------------+ |
        | | 마포 크로스핏짐                     | |
        | | 피트니스 / 헬스장                   | |
        | | 5열 8단 원함                        | |
        | | 블랙 색상                           | |
        | | 2월 중순 오픈 예정                  | |
        | | 김사장 010-1234-5678               | |
        | |                                    | |
        | +------------------------------------+ |
        |                                        |
        | [AI 정리하기]                          |
        +----------------------------------------+

대표: (전화하면서 빠르게 타이핑)
      "마포 크로스핏짐
       피트니스
       5열 8단
       블랙
       2월 중순
       김사장 010-1234-5678"

대표: [AI 정리하기] 클릭
```

---

## AI 정리 결과

```
+----------------------------------------+
| [AI 정리] 상담 내용 분석 완료          |
+----------------------------------------+
|                                        |
| [취합된 정보]                          |
| +------------------------------------+ |
| | 고객명: 마포 크로스핏짐            | |
| | 업종: 피트니스/헬스장              | |
| | 규격: 5열 8단                      | |
| | 색상: 블랙                         | |
| | 설치 예정: 2월 중순                | |
| | 담당자: 김사장                     | |
| | 연락처: 010-1234-5678              | |
| +------------------------------------+ |
|                                        |
| [미취합 정보] - 확인 필요!             |
| +------------------------------------+ |
| | [ ] 설치 지역 (서울? 경기?)        | |
| | [ ] 프레임 옵션                    | |
| | [ ] 예산 범위                      | |
| | [ ] 이메일 주소                    | |
| +------------------------------------+ |
|                                        |
| [추천 질문]                            |
| "설치 장소가 서울 마포구 맞으실까요?"  |
| "프레임은 전체로 할까요, 상단만?"      |
|                                        |
| [문의 목록에 저장]  [계속 메모]        |
+----------------------------------------+
```

### 대표가 느끼는 것
> "아, 내가 빼먹은 거 알려주네.
> 전화 끊기 전에 바로 물어볼 수 있어."

---

## 미취합 정보 확인 후

```
대표: "아, 설치 장소가 서울 마포구 맞으시죠?"
고객: "네 맞아요"
대표: "프레임은 전체로 해드릴까요?"
고객: "네, 깔끔하게요"

대표: (노트에 추가)
      "서울 마포구
       프레임 전체"

대표: [AI 정리하기] 다시 클릭
```

```
+----------------------------------------+
| [AI 정리] 상담 내용 분석 완료          |
+----------------------------------------+
|                                        |
| [취합된 정보] - 완료!                  |
| +------------------------------------+ |
| | 고객명: 마포 크로스핏짐            | |
| | 업종: 피트니스/헬스장              | |
| | 규격: 5열 8단                      | |
| | 색상: 블랙                         | |
| | 프레임: 전체                       | |
| | 설치지역: 서울 (마포구)            | |
| | 설치 예정: 2월 중순                | |
| | 담당자: 김사장                     | |
| | 연락처: 010-1234-5678              | |
| +------------------------------------+ |
|                                        |
| [미취합 정보]                          |
| +------------------------------------+ |
| | [ ] 이메일 주소 (선택)             | |
| +------------------------------------+ |
|                                        |
| [v] 필수 정보 취합 완료!               |
|                                        |
| [문의 목록에 저장] <- 활성화됨         |
+----------------------------------------+
```

---

## 문의 목록에 저장

```
대표: [문의 목록에 저장] 클릭

시스템: +----------------------------------------+
        | [저장 완료]                            |
        |                                        |
        | 마포 크로스핏짐 - 김사장님             |
        | 5열 8단 블랙, 프레임 전체              |
        |                                        |
        | 예상 견적: 3,150,000원                 |
        |                                        |
        | [바로 견적서 생성]  [나중에]           |
        +----------------------------------------+
```

---

# 기능 2. 유사 견적 추천 (연결)

## 문의 목록에서 유사 견적 찾기

```
새 상담 저장 시:

시스템: +----------------------------------------+
        | [추천] 유사 견적 발견!                 |
        |                                        |
        | 이 고객과 비슷한 이전 견적:            |
        |                                        |
        | 1. 강남 헬스플러스 (2024.03)           |
        |    5열 6단 화이트, 2,850,000원         |
        |    -> 피트니스 업종, 비슷한 규모       |
        |                                        |
        | 2. 신촌 피트니스랩 (2024.08)           |
        |    5열 8단 블랙, 3,150,000원           |
        |    -> 동일 규격, 동일 색상!            |
        |                                        |
        | [2번 견적 참고하기]                    |
        +----------------------------------------+
```

---

# 전체 UX 플로우

```
[메인 화면]
+-------------------------------------------------------------+
|  [ 새 상담 ]              문의 목록 (12건)                  |
+-------------------------------------------------------------+
|                                                             |
|  [팔로업 필요 3건]                                          |
|  +-- 마포 크로스핏짐 (오늘) - 미발송                        |
|  +-- 분당 학원 (3일) - 검토 중                              |
|  +-- 수원 오피스 (5일) - 검토 중 [긴급]                     |
|                                                             |
|  [최근 문의]                                                |
|  +-- 마포 크로스핏짐 | 5x8 블랙 | 3,150,000 | 오늘         |
|  +-- 강남 오피스텔 | 4x6 아이보리 | 2,100,000 | 어제       |
|  +-- 분당 학원 | 3x8 화이트 | 1,950,000 | 3일 전           |
|                                                             |
+-------------------------------------------------------------+
```

```
[새 상담] 클릭 시:
+-------------------------------------------------------------+
|  [상담 노트]                               [X 닫기]         |
+-------------------------------------------------------------+
|                                                             |
|  +-------------------------------------------------------+  |
|  |                                                       |  |
|  | (여기에 자유롭게 메모)                                |  |
|  |                                                       |  |
|  | 마포 크로스핏짐                                       |  |
|  | 피트니스                                              |  |
|  | 5열 8단 블랙                                          |  |
|  | 김사장 010-1234-5678                                  |  |
|  |                                                       |  |
|  +-------------------------------------------------------+  |
|                                                             |
|  [AI 정리하기]                                              |
|                                                             |
+-------------------------------------------------------------+
```

---

# 필수 정보 체크리스트

| 항목 | 필수 여부 | 자동 추출 가능 |
|------|----------|---------------|
| 고객명/회사명 | 필수 | O |
| 업종 | 권장 | O (키워드 매칭) |
| 열 수 | 필수 | O |
| 단 수 | 필수 | O |
| 색상 | 필수 | O |
| 설치 지역 | 필수 | O |
| 담당자명 | 필수 | O |
| 연락처 | 필수 | O |
| 이메일 | 선택 | O |
| 프레임 옵션 | 권장 | O |
| 설치 예정일 | 권장 | O |
| 예산 | 선택 | X |

---

# AI 자연어 파싱 예시

## 입력
```
"마포 크로스핏짐
피트니스
5열 8단 블랙
2월 중순 오픈
김사장 010-1234-5678"
```

## AI 파싱 결과
```json
{
  "company_name": "마포 크로스핏짐",
  "industry": "피트니스",
  "columns": 5,
  "tiers": 8,
  "color": "블랙",
  "installation_date": "2월 중순",
  "contact_name": "김사장",
  "contact_phone": "010-1234-5678",
  "missing": ["region", "frame_type", "email"]
}
```

---

# 기술 구현 계획

## 1. 상담 노트 UI
```javascript
// 새 상담 모달
const ConsultationNoteModal = () => {
  const [note, setNote] = useState('');
  const [parsedData, setParsedData] = useState(null);

  const handleAIParse = async () => {
    const result = await parseConsultationNote(note);
    setParsedData(result);
  };

  return (
    <Modal>
      <TextArea value={note} onChange={setNote} />
      <Button onClick={handleAIParse}>AI 정리하기</Button>
      {parsedData && <ParsedResult data={parsedData} />}
    </Modal>
  );
};
```

## 2. AI 파싱 서비스
```javascript
// backend: consultationService.js
const parseConsultationNote = async (note) => {
  const prompt = `
    다음 상담 메모에서 정보를 추출해주세요.

    메모:
    ${note}

    추출할 정보:
    - company_name: 고객명/회사명
    - industry: 업종 (피트니스, 학원, 오피스, 카페 등)
    - columns: 열 수 (숫자만)
    - tiers: 단 수 (숫자만)
    - color: 색상 (화이트, 블랙, 아이보리, 커스텀)
    - region: 설치 지역 (서울, 경기, 부산 등)
    - contact_name: 담당자명
    - contact_phone: 연락처
    - contact_email: 이메일
    - frame_type: 프레임 (전체, 상단만, 없음)
    - installation_date: 설치 예정일

    JSON 형식으로 반환해주세요.
    추출되지 않은 정보는 null로 표시하고,
    missing 배열에 누락된 필수 항목을 나열해주세요.
  `;

  return await callGemini(prompt);
};
```

## 3. DB 스키마
```sql
-- inquiries 테이블 확장
ALTER TABLE inquiries ADD COLUMN raw_note TEXT;  -- 원본 메모
ALTER TABLE inquiries ADD COLUMN industry VARCHAR(50);  -- 업종
ALTER TABLE inquiries ADD COLUMN installation_date VARCHAR(50);  -- 설치 예정일
```

---

# 구현 우선순위

## Phase 1: 상담 노트 + AI 정리
1. 상담 노트 모달 UI
2. AI 파싱 API (Gemini)
3. 필수 정보 체크 UI
4. 문의 목록 저장 연동

## Phase 2: 유사 견적 추천
1. 문의 목록 검색 기능
2. 업종별 통계
3. 유사 견적 추천 UI

## Phase 3: 자동 팔로업
1. 견적 상태 관리
2. 팔로업 알림
3. AI 메시지 생성

---

# 다음 단계

이 기획대로 구현 진행할까요?
1. 상담 노트 UI 먼저
2. AI 파싱 API 연동
3. 문의 목록 저장
