# Prompt History

## 2026-02-01
- `claude.md에 이 내용 추가해 : 앞으로 내 prompt를 입력받을 때 마다 prompt.md에 저장해`
- `새로운 '디자인' 옵션 기능을 추가할거야. sub agents들 활용해서 기획해. [[추가기능] 2D 레이아웃 생성 시, 함에 '첨부이미지' 처럼 타공 디자인을 선택할 수 있는 옵션. '추가옵션'에서 '타공디자인'을 선택하면 이 타공이 포함된 locker cell을 그리는거야. 첨부이미지 처럼 함의 특정 영역에 타공이 가득 차있는 '고급디자인'을 구현하고 싶어` (이미지 첨부: 타공 패턴 예시)
- `adjust the position of '타공'. refer to the image attached.` (이미지 첨부: 타공이 셀 상단에 위치한 실제 락커 사진)
- `아니 우선 세로 영역부터 파악해야해. 가장 왼쪽이 0, 가장 우측이 100이라면 30~100의 영역에 타공을 채우는거야`
- `그리고 해당 세로 영역에서 위아래 여백 20%씩 있어야해`
- `타공 디자인 옵션 구현 계획 승인 후 구현 시작` (계획: 백엔드 가격/이미지 로직 + 프론트엔드 UI)
- `타공 패턴 수정: 1. 구멍 훨씬 작게 2. 엇갈린 패턴 (staggered/honeycomb) - 줄마다 시작점 다르게`
- `제어부 타입 옵션 구현 계획 승인 및 구현 시작` (QR타입/일반형/배리어프리 3가지 타입)
- `프레임 상단 텍스트 커스터마이징 기능 구현` (물품보관함, LOCKER, 택배보관함, 직접입력 - 2D/3D/Excel 반영)
- `제어부 색상 처리 개선 계획 구현` (화면 오버레이 방식 - 색상 틴트 후 screen.png 덮어씌움)
- `일반 기준 -> 첨부이미지 상태. 이미지 2배로 키우고 아래로 살짝 내려야 함.`
- `5%만 더 키우고 2px아래로 내려`
- `7% 더 키워`
- `크기 2%더 키워`
- `이미지 너무 커졌다 10% 줄여`
- `10% 더 줄여`
- `10% 더 줄이고 왼쪽으로 10px 옮겨`
- `3% 더 줄이고 왼쪽으로 10px`
- `왼쪽으로 20px`
- `좌우로 약간 늘리고 왼쪽으로 살짝 옮겨`
- `왼쪽으로 15px, 아래로 5px`
- `좌우 살짝 줄이고 왼쪽으로 15px. 위아래 5px 늘려`
- `좌우 10px 더 늘려. 우측으로`
- `프레임 문구 UI 수정` - 프리셋: 물품보관함, 무인물품보관함, 반입금지물품보관, 직접입력 / 버튼 찌그러짐 수정 (flex-shrink:0, white-space:nowrap)
- `배리어프리 화면 오버레이 설정 구현` - barrier-free 초기값 설정 (x:35, y:50, scaleX:0.76, scaleY:0.73)
- `배리어프리 2배 높이 수정` - BARRIER_FREE_HEIGHT 상수 추가, 제어부 계산 로직 분기, 리사이즈 시 2배 높이 적용
- `배리어프리 크기 조정` - 높이 1.8배, 너비 80% (120x410px), 가운데 정렬
- `'세트 수' 옵션을 '프레임' 왼쪽으로 옮겨`
- `프레임 문구 위치: 풀옵션/상부만 버튼 바로 아래 정렬` - frameType별 동적 marginLeft
- `프레임 문구 marginLeft 조정` - 풀옵션: 227px, 상부만: 287px
- `프레임 문구 프리셋 수정` - '반입금지물품보관' → '반입금지물품보관함'
- `프레임 문구 프리셋 추가` - '무인물품보관함' 우측에 '냉장보관함' 추가
- `직접입력 input 너비 축소` - 140px → 110px
- `함 구성 옵션 폰트크기 동일 확인 + '단수' → '단 수' 변경`
- `열/단 설정 앞에 '기본 구성' 타이틀 추가`
- `수동모드를 기본값으로 변경 + 탭 버튼 스타일 차별화` - 수동모드 탭: 흰색 배경, 에이전트 탭: 네이비 그라데이션 움직이는 배경 (4초 애니메이션)
- `에이전트 버튼 밝은 파랑 그라데이션으로 변경` - #3b82f6, #60a5fa, #38bdf8, #818cf8
- `열별 단수 조절 기능 구현` - columnConfigs 배열로 각 열별 독립적 단수/높이비율 조정, 복사/붙여넣기 기능
- `배리어프리 locker cell에 스피커 구멍 추가` - 왼쪽 상단에 작은 스피커 구멍 패턴
- `스피커 구멍 구현하자. 동그란 타공이 모여서 6각형 벌집모양이 되는거야.`
- `현재 3D 이미지 생성하는 프롬프트 점수 매겨봐 100점 만점. 특히 '행과 열'을 정확히 follow해서 그릴 수 있는지에 가산점 줘` - 점수: 58/100점 (기본 70, 프레임 75, 행/열 정확도 35, 프롬프트 엔지니어링 55)
- `현재 프롬프트를 backup파일로 복사해두고, 100점짜리 프롬프트로 개선해` - geminiService.backup.js 생성, 프롬프트 v2.0 적용 (Positive framing, Transform→Render, 간결화, PRIORITY 1 구조 보존)
- `배리어프리일 때 완전히 구성이 망가져. 기본적으로 행, 열 정보를 넘기는거 맞나?` - 문제: 3D API에 controlPanelType, columnConfigs 정보 누락. 수정: FE→BE→geminiService 전체 파이프라인에 배리어프리 정보 추가
- `QR의 경우 아예 스크린이 없는 구조인데 어떻게 이 레이아웃을 가지고 '스크린'을 만들어내지?` - 2D에 스크린 없는데 3D에 Gemini가 임의로 스크린 추가하는 문제 발견
- `제어부 타입별 프롬프트 분기` - 일반/QR/배리어프리 각각 전용 프롬프트 생성
- `프롬프트 롤백 + 제어부 타입 분기 계획 구현` - v5.0: 원본 프롬프트 구조(countDescription: ASCII 그리드, FAILURE/SUCCESS CONDITIONS) 복원 + 제어부 타입별 분기 추가 (QR: 스크린 금지, 배리어프리: 큰 터치스크린 구조, 일반: 제어부 위치 명시)
- `일반타입 : 통과. QR타입 -> 자꾸 스크린 만들고 있음` - v5.1: QR 타입 스크린 금지 3중 강화 (gridPriming 시작부, FAILURE/SUCCESS CONDITIONS, gridReminder 끝부분 모두에 스크린 금지 문구)

## 2026-02-02
- `https://github.com/anthropics/skills/tree/main/skills/xlsx 이거 확인해서 전역에 excel skills 추가하고 전역 claude.md에도 엑셀관련 작업은 이 스킬 무조건 쓰게 해` - 전역 /xlsx 스킬 생성 + 전역 CLAUDE.md에 "Excel/XLSX Work → Auto XLSX" 자동 오케스트레이션 규칙 추가 + 프로젝트 CLAUDE.md에도 Excel 작업 필수 규칙 추가
- `/xlsx 사용해서 Excel 견적서 3D 이미지 중앙 정렬 수정` - 원인: 캔버스(600px)를 col:0에 배치했으나 시트 너비(780px)와 불일치 → 해결: 시트 너비 기준으로 이미지 col 시작점을 동적 계산 ((8 - imageColSpan) / 2)
- `Footer 고정 + 2D 레이아웃 크기 증가` - Footer: 셀 기반 → Excel pageSetup.headerFooter로 변경 (인쇄 시 항상 같은 위치), 2D 레이아웃: 크기 30% 증가 (availableWidth * 0.95 → 1.235, maxHeight 220 → 286)
- `표지 3D 이미지 중앙정렬 + 수신 형식 + 행 높이 수정` - 3D 이미지: 픽셀 변환 7.5→8.43으로 수정 (Calibri 기준), 제품명: "n열×n단"→"n세트"로 변경, 수신: "수신: 회사명 귀하" 형식으로 변경, 상세견적서 행 높이: 기본 30→42, 줄당 12→16pt로 증가
- `모달의 "3D 이미지 생성" 버튼 액션 수정` - 문제: 모달에서 클릭 시 아무 일도 없음 → 해결: previewImage 존재 여부 확인 후 (1) 있으면 handleGenerate3D() 호출, (2) 없으면 2D 생성 섹션으로 스크롤
- `표지 3D 이미지 중앙 정렬 재조정` - 문제: 살짝 우측 치우침 → 해결: 픽셀 변환 계수 8.43→7.5로 재조정 (ExcelJS 실제 렌더링 기준)
- `완전히 분리해버려. QR전용 프롬프트부터 만들어봐` - v6.0: QR 타입 완전 분리 프롬프트 (2D를 그대로 3D로 변환, 프레임만 공통 사용, 간결한 지시문)
- `"락커"라는 말때문에 그런가? 아무것도 추가하지 말고 이 그림을 3D로 그리라고 해` - v6.1: 극단적 단순화 - "locker", "door", "screen" 등 모든 힌트 제거. "DO NOT ADD ANYTHING. Just convert to 3D exactly as shown."
- `열별 높이 비균등 설정 기능 추가` - 제어부 파란색 배경 제거, Stepper 숫자 클릭 시 팝오버로 해당 열의 높이 비균등 설정 (균등/비균등 토글, 슬라이더 UI)
- `비균등 슬라이더 버벅임 수정` - onChange에서 로컬 상태만 업데이트, onMouseUp/onTouchEnd에서만 이미지 API 호출
- `단 수 조절 시 다른 열 비균등 리셋 버그 수정` - shallow copy → deep copy (deepCopyColumnConfigs 헬퍼 함수 추가)
- `비균등 레이아웃 생성 후 단 수/높이 조절 시 다른 열 균등으로 리셋되는 버그 수정` - 견적 생성 시 columnConfigs 항상 생성 (formData.tierConfig 기반), previewConfig에 tierConfig 저장하여 fallback으로 사용
- `열별 비균등 비율 복사/붙여넣기 기능` - 특정 열의 비균등 비율을 복사해서 다른 열에 적용 (copiedTierConfig 상태, 단 수 다른 경우 자동 조정)
- `추가옵션에서 '아크릴도어'와 '타공디자인' 순서 바꾸고 둘 중에 하나만 고를 수 있게 해. 둘 다 선택 불가하게` - 순서 변경 (타공디자인 → 아크릴도어), 상호 배타적 선택 로직 추가, disabled 스타일 적용
- `'아크릴도어' 옵션 구현하자. locker cell의 세로 가운데에 얇은 '창문'을 만드는거야. 검은색이고 빛이 비치는 효과만 살짝 주면 돼` - drawAcrylicWindow 함수 추가, 셀 중앙에 검은 창문 + 하이라이트 효과
- `위치 우측으로 15px 옴기고 높이 절반으로 줄여` - 아크릴 창문: 높이 40%→20%, 우측 15px 오프셋
- `왼쪽으로 5px 옮기고 빛이 검정색에 비치는 효과 더 자연스럽게 진짜처럼 구현해. 높이 2/3로 줄이고` - 우측 10px 오프셋, 높이 13.3%, 대각선 그라데이션 + 스트라이프 + 가장자리 반사
- `빛 반사 효과 좀 더 명확히 줘봐` - 하이라이트 강도 2배 (55→100, 30→60), 영역 확장 (0.35→0.45), 가장자리 반사 강화
- `타이틀 왼쪾의 애니메이션- 이거 너무 버벅이는데` - Blur 값 절반 감소 (8→4px, 12→5px, 14→6px, 16→7px) + GPU 가속 (will-change: transform)
- `'새 상담'에서 분석하기 누르면 gemini api가 도는데, 이걸 vercel에서 어떤 프로젝트에 환경변수 넣어야하지?` - Vercel Backend (world-quotation-backend)에 GEMINI_API_KEY 추가 필요
- `'상담 메모 분석 시작'로그에 메모 내용 전부 다 보내는게 어떄?` - 로그에 전체 메모 포함
- `로그 좌우에 괄호포함하자.`
## 2026-02-02 03:42:41
CLAUDE.md에 Notion 업무 체계 추가 계획 실행

## 2026-02-02 09:06
- `내가 찾아보니, 사람들이 젤 많이 쓰는 MCP중 하나가 노션이야. 우리도 방법을 찾아야해. 어려운게 아니야. 지금 읽는건 되는거잖아? 근데 write가 안되는거고. 해결책 잘 찾아보고 아무 페이지나 생성해봐 테스트로`
- 해결: Notion MCP의 API-post-page에 $ref 파라미터 버그 있음. 직접 Notion API 호출로 해결
- 핵심: API 버전 `2025-09-03` + parent 형식 `{"type": "data_source_id", "data_source_id": "..."}`
- 탑이앤씨 통화메모 기반 7개 Task 생성 완료:
  1. 해상도 낮은 이미지 확인 및 교체 (디자인)
  2. 조직도 - 영업부, 기술부 라인 끊김 수정 (오류수정)
  3. BIT정보안내단말기 이미지 교체 - 설치사례 삭제 (컨텐츠 수정)
  4. VMS 수정 - 정의 텍스트 변경 + 스마트전광판 이미지 제거 (컨텐츠 수정)
  5. 스마트전광판 페이지 수정 (컨텐츠 수정)
  6. 음성안내기 사진 교체 - 설치사례 삭제 (컨텐츠 수정)
  7. 셔틀버스 음성안내시스템 - 이미지 잘림 수정 (오류수정)
